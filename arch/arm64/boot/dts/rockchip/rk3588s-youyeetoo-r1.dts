// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2021 Rockchip Electronics Co., Ltd.
 *
 */

/dts-v1/;

#include "rk3588s-yyt-common.dtsi"

/ {
    model = "Youyeetoo R1";
    compatible = "youyeetoo,r1", "rockchip,rk3588";

    gpio_keys: gpio-keys {
        compatible = "gpio-keys";
        pinctrl-names = "default";
        pinctrl-0 = <&key1_pin>;

        button@1 {
            debounce-interval = <50>;
            gpios = <&gpio1 RK_PC0 GPIO_ACTIVE_LOW>;
            label = "K1";
            linux,code = <BTN_1>;
            wakeup-source;
        };
    };

    vcc5v0_host_20: vcc5v0-host-20 {
        compatible = "regulator-fixed";
        enable-active-high;
        gpio = <&gpio4 RK_PB5 GPIO_ACTIVE_HIGH>;
        pinctrl-names = "default";
        pinctrl-0 = <&vcc5v0_host20_en>;
        regulator-name = "vcc5v0_host_20";
        regulator-min-microvolt = <5000000>;
        regulator-max-microvolt = <5000000>;
        vin-supply = <&vcc5v0_usb>;
    };

    usb30_power_ver1 {//1c7
        compatible = "lylx,xgpio";
        gpio = <&gpio4 7 GPIO_ACTIVE_HIGH>;
        def_val = <1>;
        status = "okay";
    };

    usb30_power {//0 B0
        compatible = "lylx,xgpio";
        gpio = <&gpio0 8 GPIO_ACTIVE_HIGH>;
        def_val = <1>;
        status = "okay";
    };
};

&pinctrl {
    gpio-key {
        key1_pin: key1-pin {
            rockchip,pins = <1 RK_PC0 RK_FUNC_GPIO &pcfg_pull_up>;
        };
    };

    usb {
        vcc5v0_host20_en: vcc5v0-host20-en {
            rockchip,pins = <4 RK_PB5 RK_FUNC_GPIO &pcfg_pull_none>;
        };
        vcc5v0_host_en: vcc5v0-host-en {
            rockchip,pins = <1 RK_PB1 RK_FUNC_GPIO &pcfg_pull_none>;
        };
    };
};

&i2c6 {
    status = "okay";
    pinctrl-names = "default";
    pinctrl-0 = <&i2c6m3_xfer>;

    hym8563: hym8563@51 {
        compatible = "haoyu,hym8563";
        reg = <0x51>;
        #clock-cells = <0>;
        clock-frequency = <32768>;
        clock-output-names = "hym8563";
        status = "okay";
    };
};

&u2phy0 {
    status = "okay";
};

&u2phy2 {
    status = "okay";
};

&u2phy2_host {
    phy-supply = <&vcc5v0_host_20>;
    status = "okay";
};

&vp0 {
    rockchip,plane-mask = <(1 << ROCKCHIP_VOP2_CLUSTER0 | 1 << ROCKCHIP_VOP2_ESMART0 | 1 << ROCKCHIP_VOP2_CLUSTER1)>;
    rockchip,primary-plane = <ROCKCHIP_VOP2_CLUSTER0>;
    cursor-win-id = <ROCKCHIP_VOP2_ESMART0>;
};

&vp1 {
    rockchip,plane-mask = <(1 << ROCKCHIP_VOP2_CLUSTER2 | 1 << ROCKCHIP_VOP2_ESMART1 | 1 << ROCKCHIP_VOP2_ESMART2)>;
    rockchip,primary-plane = <ROCKCHIP_VOP2_CLUSTER2>;
    cursor-win-id = <ROCKCHIP_VOP2_ESMART1>;
};

&vp2 {
    /delete-property/ rockchip,plane-mask;
    /delete-property/ rockchip,primary-plane;
    status = "disabled";
};

&vp3 {
    /delete-property/ rockchip,plane-mask;
    /delete-property/ rockchip,primary-plane;
    status = "disabled";
};

// USB2 PHY node for USB3
&u2phy2 {
    status = "okay";
};

&u2phy2_host {
    phy-supply = <&vcc5v0_host_20>;
    status = "okay";
};

// USB3 Controller
&usbdrd3_0 {
    dr_mode = "host";
    maximum-speed = "super-speed";
    phys = <&u2phy2>;
    phy-names = "usb3-phy";
    status = "okay";
};

// Ensure USB 2.0 host is properly configured
&usb_host0_ehci {
    dr_mode = "host";
    status = "okay";
};

&usb_host0_ohci {
    dr_mode = "host";
    status = "okay";
};

&usb_host1_ehci {
    dr_mode = "host";
    status = "okay";
};

&usb_host1_ohci {
    dr_mode = "host";
    status = "okay";
};
